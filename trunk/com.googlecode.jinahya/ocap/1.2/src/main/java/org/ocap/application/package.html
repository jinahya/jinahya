<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="package_files/filelist.xml">
<title>package</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Ken Barringer</o:Author>
  <o:LastAuthor>Mark Dulapa</o:LastAuthor>
  <o:Revision>7</o:Revision>
  <o:TotalTime>4</o:TotalTime>
  <o:Created>2007-07-23T19:09:00Z</o:Created>
  <o:LastSaved>2009-04-03T16:57:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>997</o:Words>
  <o:Characters>5684</o:Characters>
  <o:Company>CableLabs</o:Company>
  <o:Lines>47</o:Lines>
  <o:Paragraphs>13</o:Paragraphs>
  <o:CharactersWithSpaces>6668</o:CharactersWithSpaces>
  <o:Version>11.9999</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:RelyOnVML/>
 </o:OfficeDocumentSettings>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;
	mso-font-alt:"Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h2
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"MS Mincho";
	font-weight:bold;}
p
	{mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
code
	{font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
<meta content="Jon Courtney and Brent Foust" name=Author>
<!-- Edited by Brent Foust --><!-- Edited by Pat Ladd --><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="6146"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<p>This package contains APIs for controlling the lifecycle of applications.
This package is primarily used by the monitor application.</p>

<h2><a name=AppReg>Application Registration</a></h2>

<p>This package provides methods for registering and unregistering unbound
applications. The <span class=SpellE><span class=GramE>AppManagerProxy.registerUnboundApp</span></span><span
class=GramE>(</span>InputStream) method registers unbound applications
specified by the InputStream that contains XAIT data. This is a similar
function described as the signaling of unbound application using the XAIT (See
section 11.2.2.1 <i>Signaling of Unbound Applications).</i> The <span
class=GramE>AppManagerProxy.unregisterUnboundApp(</span>AppID) method
unregisters an unbound application specified by AppID.</p>

<p>The format of the XAIT SHALL follow Section 11.2.2.3 OCAP XAIT stated in
this Specification.</p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=AppInfo>Application Information</a></h2>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
<span class=SpellE>org.ocap.application.OcapAppAttributes</span> shall be used
instead of the <span class=SpellE>org.dvb.application.AppAttributes</span>.</p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=XAITUpdatingMgmt>XAIT updating Management</a></h2>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>In
order to manage the updating of network signaled applications on the receiver,
the monitor application MAY reject a new XAIT to abort updating unbound
application information in the <span class=SpellE>AppsDatabase</span>. It can
set the <span class=SpellE>AppSignalHandler</span> via <span class=SpellE><span
class=GramE>AppManagerProxy.setAppSignalHandler</span></span><span class=GramE>(</span><span
class=SpellE>AppSignalHandler</span>). When a new XAIT is received, the <span
class=GramE>AppSignalHandler.notifyXAITUpdate(</span>OcapAppAttributes[]) is
called to allow the monitor application to make a decision of whether to update
unbound application information. </p>

<h2 style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'><a
name=PolicySecurity>Policy and Security Management</a></h2>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Black
and white list support is provided by the <span class=SpellE>AppFilter</span>
class. The application manager allows a filter to be set which all applications
must pass through before being run.</p>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
monitor application can register an application filter to prevent applications
from running. When an application is being launched, the application manager
tests the application against the filter. If the test fails, the application
will be blocked as described in Chapter 21. See <span class=SpellE><code><span
style='font-size:10.0pt'>AppManagerProxy.setAppFilter</span></code></span>
method for filter registration.</p>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>This
is sample code of application filtering. The monitor application MAY create a
unique application filter class that extends the <span class=SpellE><code><span
style='font-size:10.0pt'>org.dvb.application.AppsDatabaseFilter</span></code></span>
class. It MAY implement an unique algorithm to filter an application in the <span
class=GramE>accept(</span>) method.</p>

<pre><o:p>&nbsp;</o:p></pre><pre><span class=GramE>import</span> org.ocap.application.*;</pre><pre><span
class=GramE>import</span> <span class=SpellE>org.dvb.application</span>.*;</pre><pre><o:p>&nbsp;</o:p></pre><pre><span
class=GramE>public</span> class <span class=SpellE>MAAppFilter</span> extends <span
class=SpellE>AppsDatabaseFilter</span> {</pre><pre><span style='mso-spacerun:yes'>    </span>/**</pre><pre><span style='mso-spacerun:yes'>     </span>* Constructor of this class. </pre><pre><span style='mso-spacerun:yes'>     </span>*/</pre><pre><span style='mso-spacerun:yes'>    </span><span
class=GramE>public</span> <span class=SpellE>MAAppFilter</span>() {</pre><pre><span style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'>  </span>AppManagerProxy <span
class=SpellE>appMgrProxy</span> = <span class=SpellE><span class=GramE>AppManagerProxy.getInstance</span></span><span
class=GramE>(</span>);</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* Register an application filter. */</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=SpellE><span class=GramE>appMgrProxy.setAppFilter</span></span><span
class=GramE>(</span>this);</pre><pre><span style='mso-spacerun:yes'>    </span>}</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>    </span>/**</pre><pre><span style='mso-spacerun:yes'>     </span>* Implement the <span
class=GramE>accept(</span>) method defined in the <span class=SpellE>AppsDatabaseFilter</span>. </pre><pre><span style='mso-spacerun:yes'>     </span>*/</pre><pre><span style='mso-spacerun:yes'>    </span><span
class=GramE>public</span> boolean accept(AppID <span class=SpellE>appid</span>) {</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>int</span> REJECTED_OID = 0x1234;</pre><pre><span style='mso-spacerun:yes'>        </span></pre><pre><span style='mso-spacerun:yes'>        </span>/* <span
class=GramE>Investigate</span> the specified applications. */</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>if(</span><span class=SpellE>appid.getOID</span>() == REJECTED_OID) {</pre><pre><span style='mso-spacerun:yes'>            </span><span
class=GramE>return</span> false;</pre><pre><span style='mso-spacerun:yes'>        </span>}</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>return</span> true;</pre><pre><span style='mso-spacerun:yes'>    </span>}</pre><pre>}</pre>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>The
monitor application MAY set the <span class=SpellE>SecurityPolicyHandler</span>
via the <span class=SpellE><span class=GramE>AppManagerProxy.setSecurityPolicyHandler</span></span><span
class=GramE>(</span><span class=SpellE>SecurityPolicyHandler</span>) method.
For those applications that pass through the current application filter, the <span
class=SpellE><span class=GramE>SecurityPolicyHandler.getAppPermissions</span></span><span
class=GramE>(</span><span class=SpellE>PermissionsInformation</span>) method is
called. The monitor application can get a <span class=SpellE>PermissionCollection</span>
and return it as the return value of <span class=SpellE>getAppPermissions</span>
method. The application is launched using the modified <span class=SpellE>PermissionCollection</span>.</p>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>Monitor
applications that set the <span class=SpellE>SecurityPolicyHandler</span>
should take care when setting permissions for Host Device Manufacturer
applications (i.e. applications where <span class=SpellE><span class=GramE>PermissionCollection.isManufacturerApp</span></span><span
class=GramE>(</span>) returns true). Denying permissions to Host Device
Manufacturer applications may cause an extremely poor user experience. </p>

<p style='tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt'>This
is sample code for modifying <span class=SpellE>PermissionCollection</span>. It
denies the <span class=SpellE>AppsControlPermission</span> to a specified
application, but grants all other requested permissions. </p>

<pre><o:p>&nbsp;</o:p></pre><pre><span class=GramE>import</span> org.ocap.application.*;</pre><pre><span
class=GramE>import</span> <span class=SpellE>org.dvb.application</span>.*;</pre><pre><span
class=GramE>import</span> <span class=SpellE>java.security</span>.*;</pre><pre><span
class=GramE>import</span> <span class=SpellE>java.util</span>.*;</pre><pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre><pre><span
class=GramE>public</span> class <span class=SpellE>MAPermissionModifier</span> implements <span
class=SpellE>SecurityPolicyHandler</span> {</pre><pre><span style='mso-spacerun:yes'>    </span>/**</pre><pre><span style='mso-spacerun:yes'>     </span>* Constructor of this class. </pre><pre><span style='mso-spacerun:yes'>     </span>*/</pre><pre><span style='mso-spacerun:yes'>    </span><span
class=GramE>public</span> <span class=SpellE>MAPermissionModifier</span>() {</pre><pre><span style='mso-spacerun:yes'>        </span>AppManagerProxy <span
class=SpellE>appMgrProxy</span> = <span class=SpellE><span class=GramE>AppManagerProxy.getInstance</span></span><span
class=GramE>(</span>);</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* Register <span
class=SpellE>SecurityPolicyHandler</span> applications. */</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=SpellE><span class=GramE>appMgrProxy.setSecurityPolicyHandler</span></span><span
class=GramE>(</span>this);</pre><pre><span style='mso-spacerun:yes'>    </span>}</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>    </span>/**</pre><pre><span style='mso-spacerun:yes'>     </span>* Implement the <span
class=SpellE>getAppPermission</span> method defined in <span class=SpellE>SecurityPolicyHandler</span>. </pre><pre><span style='mso-spacerun:yes'>     </span>*/</pre><pre><span style='mso-spacerun:yes'>    </span><span
class=GramE>public</span> <span class=SpellE>PermissionCollection</span> <span
class=SpellE>getAppPermissions</span>(</pre><pre><span style='mso-spacerun:yes'>            </span><span
class=SpellE>PermissionInformation</span> <span class=SpellE>permissionInfo</span>) {</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* <span
class=GramE>Investigate</span> the requested <span class=SpellE>PermissionCollection</span> here. */</pre><pre><span style='mso-spacerun:yes'>        </span>AppID <span
class=SpellE>appid</span> = <span class=SpellE><span class=GramE>permissionInfo.getAppID</span></span><span
class=GramE>(</span>);</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=SpellE>PermissionCollection</span> <span class=SpellE>requestedPermissionCollection</span> </pre><pre><span style='mso-spacerun:yes'>                </span>= <span
class=SpellE><span class=GramE>permissionInfo.getRequestedPermissions</span></span><span
class=GramE>(</span>);</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* Give manufacturer applications everything they ask for */</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>if</span> (<span class=SpellE>permissionInfo.isManufacturerApp</span>()) {</pre><pre><span style='mso-spacerun:yes'>            </span><span
class=GramE>return</span> <span class=SpellE>requestedPermissionCollection</span>;</pre><pre><span style='mso-spacerun:yes'>        </span>}</pre><pre><o:p>&nbsp;</o:p></pre><pre> <span style='mso-spacerun:yes'>       </span>/* Start with the basic permissions for unsigned applications */</pre><pre><span style='mso-spacerun:yes'>        </span>/* Note that we are guaranteed that these permissions will always */</pre><pre><span style='mso-spacerun:yes'>        </span>/* be a subset of the requested permissions */</pre><pre><span style='mso-spacerun:yes'>        </span>Permissions <span
class=SpellE>newPermissionCollection</span> = new <span class=GramE>Permissions(</span>);</pre><pre><span style='mso-spacerun:yes'>        </span>Enumeration e = <span
class=SpellE><span class=GramE>PermissionInformation.getUnsignedAppPermissions</span></span><span
class=GramE>(</span>).elements();</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>while</span> (<span class=SpellE>e.hasMoreElements</span>()) {</pre><pre><span style='mso-spacerun:yes'>            </span><span
class=SpellE><span class=GramE>newPermissionCollection.add</span></span><span
class=GramE>(</span>(Permission)<span class=SpellE>e.nextElement</span>())</pre><pre><span style='mso-spacerun:yes'>        </span>}</pre><pre><o:p>&nbsp;</o:p></pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* <span
class=GramE>The</span> permission we are going to deny */</pre><pre><span style='mso-spacerun:yes'>        </span>Permission <span
class=SpellE>appsControlPermission</span> = new <span class=SpellE><span
class=GramE>AppsControlPermission</span></span><span class=GramE>(</span>);</pre><pre><span style='mso-spacerun:yes'>        </span>AppId <span
class=SpellE>denyAppsControlPermissionAppId</span> = new <span class=GramE>AppId(</span>1, 2);</pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span>/* <span
class=GramE>Modify</span> the <span class=SpellE>PermissionCollection</span> here. */</pre><pre><span style='mso-spacerun:yes'>        </span>/* Note that the modified permissions shall be a subset of the */</pre><pre><span style='mso-spacerun:yes'>        </span>/* requested permission. */</pre><pre><span style='mso-spacerun:yes'>        </span>e = <span
class=SpellE><span class=GramE>requestedPermissionCollection.elements</span></span><span
class=GramE>(</span>);</pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>while</span> (<span class=SpellE>e.hasMoreElements</span>()) {</pre><pre><span style='mso-spacerun:yes'>            </span>Permission requested = (Permission<span
class=GramE>)<span class=SpellE>e.nextElement</span></span>();</pre><pre><span style='mso-spacerun:yes'>            </span><span
class=GramE>if</span> (!<span class=SpellE>newPermissionCollection.implies</span>(requested)) {</pre><pre><span style='mso-spacerun:yes'>                </span>/* It's not a permission we have already granted.<span style='mso-spacerun:yes'>  </span>Test it. */</pre><pre><span style='mso-spacerun:yes'>                </span>/* (The above test is an optimization to avoid granting */</pre><pre><span style='mso-spacerun:yes'>                </span>/* the unsigned app permissions twice) */</pre><pre><span style='mso-spacerun:yes'>                </span><span
class=GramE>if</span> (<span class=SpellE>requested.implies</span>(<span
class=SpellE>appsControlPermission</span>)</pre><pre><span style='mso-spacerun:yes'>                 </span>&amp;&amp; <span
class=SpellE><span class=GramE>appid.equals</span></span><span class=GramE>(</span><span
class=SpellE>denyAppsControlPermissionAppId</span>)) {</pre><pre><span style='mso-spacerun:yes'>                     </span>/* <span
class=GramE>Deny</span> requested permission */</pre><pre><span style='mso-spacerun:yes'>                </span>} else {</pre><pre><span style='mso-spacerun:yes'>                     </span>/* ... could have other tests here ... */</pre><pre><span style='mso-spacerun:yes'>          </span><span style='mso-spacerun:yes'>           </span>/* Grant requested permission */</pre><pre><span style='mso-spacerun:yes'>                    </span><span
class=SpellE><span class=GramE>newPermissionCollection.add</span></span><span
class=GramE>(</span>requested);</pre><pre><span style='mso-spacerun:yes'>                </span>}</pre><pre><span style='mso-spacerun:yes'>            </span>}</pre><pre><span style='mso-spacerun:yes'>        </span>}</pre><pre> </pre><pre><o:p>&nbsp;</o:p></pre><pre><span style='mso-spacerun:yes'>        </span><span
class=GramE>return</span> <span class=SpellE>newPermissionCollection</span>;</pre><pre><span style='mso-spacerun:yes'>    </span>}</pre><pre>}</pre></div>

</body>

</html>
